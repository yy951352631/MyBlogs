// build time:Wed Aug 07 2019 12:42:02 GMT+0800 (GMT+08:00)
(function(t){t.fn.extend({AutoComplete:function(e){return this.each(function(){if(!(this&&this.tagName==="INPUT"&&this.type==="text")){return}if(this.controller){this.controller.setOption(e)}else{if(t.isPlainObject(e)){this.controller=new i(this,e)}}})}});var i=function(i,s){this.option=t.extend(false,{width:320,maxHeight:null,itemHeight:null,listStyle:"normal",listDirection:"down",data:[],ajaxDataType:"json",ajaxParams:{},ajaxTimeout:3e3,ajaxType:"GET",maxItems:20,matchHandler:d,emphasisHandler:y,createItemHandler:null,beforeLoadDataHandler:null,afterSelectedHandler:null,async:false,emphasis:true,onerror:null},s);e.apply(this,[i]);a.apply(this)};var e=function(i){var e=this;this.inputView=t(i);this.inputView.attr("autocomplete","off").keyup(this._keyup=function(t){switch(t.keyCode){case 13:case 16:case 17:case 37:case 38:case 39:case 40:case 9:break;case 27:p.apply(e);break;default:if(e.option.async){setTimeout(function(){u.apply(e)},0)}else{u.apply(e)}}}).keydown(this._keydown=function(t){switch(t.keyCode){case 38:h.apply(e,["up"]);break;case 40:case 9:h.apply(e,["down"]);return false;break;case 13:var i=e.searchView.is(":visible");l.apply(e);if(i){return false}break}}).blur(this._blur=function(){t(document).one("click",function(){p.apply(e)})})};var a=function(){var i=this;this.searchView=t("<div class='ac'><ul></ul></div>").appendTo("div.acParent").on("mouseenter","li",function(){i.searchView.find("li.selected").removeClass("selected");t(this).addClass("selected")}).on("mouseleave","li",function(){t(this).removeClass("selected")}).on("click","li",function(){l.apply(i);p.apply(i)}).css("font-size",this.inputView.css("font-size"));t(window).resize(function(){n.apply(i)})};var s=function(i){var e=this,a=this.searchView.find("ul").empty();if(t.inArray(this.option.listStyle,["normal","iconList","custom"])==-1){throw["遇到未知的listStyle参数！"]}t.each(i,function(i,s){var n=t("<li><div></div></li>").appendTo(a).addClass(e.option.listStyle).data("data",s).find("div");switch(e.option.listStyle){case"normal":n.append("<span>"+s.label+"</span>");break;case"iconList":var o=t("<img></img>").attr("src",s.image);n.append(t("<div></div>").append(o)).append("<span>"+s.label+"</span>");break;case"custom":n.append(e.option.createItemHandler.apply(e,[i,s]));case"default":break}if(e.option.itemHeight>0){n.height(e.option.itemHeight).css("max-height",e.option.itemHeight)}})};var n=function(){if(this.option.listDirection==="down"){var t=this.inputView.offset().top+this.inputView.outerHeight()}else{if(this.option.listDirection==="up"){var t=this.inputView.offset().top-this.searchView.outerHeight()}else{throw"遇到未知的listDirection参数！"}}var i=this.inputView.offset().left;this.searchView.css("top",t+"px").css("left",i+"px")};var o=function(){if(typeof this.option.width==="string"&&this.option.width.toLowerCase()==="auto"){return this.inputView.outerWidth()-2}else{if(typeof this.option.width==="number"){return this.option.width}else{throw"遇到未知的width参数！"}}};var r=function(i){var e=this;if(this.option.listDirection==="up"){i=i.reverse()}try{s.apply(e,[i]);if(this.option.maxHeight>0){this.searchView.css("max-height",this.option.maxHeight+"px");if(t.browser.msie){this.searchView.css("height",this.searchView.height()>this.option.maxHeight?this.option.maxHeight+"px":"auto")}}n.apply(this);this.searchView.css("width",o.apply(this)+"px")}catch(a){f.apply(this,[a+""]);return}this.searchView.show();h.apply(this,[this.option.listDirection])};var p=function(){this.searchView.find("ul").empty();this.searchView.hide()};var h=function(t){var i=this.searchView.find("li.selected");if(i.size()){var e=t==="up"?i.prev():i.next()}else{var e=t==="up"?this.searchView.find("li").last():this.searchView.find("li").first()}if(e.size()){this.searchView.find("li").removeClass("selected");e.addClass("selected");var a=e.outerHeight();var s=e.position().top;if(a+s>this.searchView.height()){this.searchView.scrollTop(this.searchView.scrollTop()+s+a-this.searchView.height())}else{if(s<0){this.searchView.scrollTop(this.searchView.scrollTop()+s)}}}};var l=function(){var i=this,e=this.searchView.find("li.selected");if(e.size()){var a=e.data("data");this.inputView.val(a.value).change();if(t.isFunction(this.option.afterSelectedHandler)){try{this.option.afterSelectedHandler.apply(i,[a])}catch(s){f.apply(this,["调用afterSelectedHandler错误:"+s]);return}}p.apply(this)}};var c=function(i){jQuery.support.cors=true;var e=this,a=[],s={async:false,dataType:e.option.ajaxDataType,type:e.option.ajaxType,timeout:this.option.ajaxTimeout,success:function(i,s,n){if(e.option.ajaxDataType==="xml"){t(i).find("item").each(function(){var i={value:t(this).text(),label:t(this).text()};for(var e=0;e<this.attributes.length;e++){var s=this.attributes[e].nodeName,n=this.attributes[e].nodeValue;i[s]=n}a.push(i)})}else{if(e.option.ajaxDataType==="json"){a=i}else{throw"遇到未知的ajaxDataType参数！"}}},error:function(t,i,e){throw e}};if(t.isPlainObject(this.option.ajaxParams)){s["data"]=t.extend(false,{keyword:i},this.option.ajaxParams)}else{if(t.isFunction(this.option.ajaxParams)){s["data"]=t.extend(false,{keyword:i},this.option.ajaxParams.apply(this,[i]))}else{if(typeof this.option.ajaxParams==="string"){s["data"]="keyword="+i+"&"+this.option.ajaxParams}else{throw"遇到未知的ajaxParams参数！"}}}t.ajax(this.option.data,s);return a};var u=function(){var i=this,e=this.inputView.val(),a=[],s=true,n=[];if(t.trim(e).length==0){p.apply(i);return}if(t.isFunction(this.option.beforeLoadDataHandler)){try{s=this.option.beforeLoadDataHandler.apply(this,[e])}catch(o){f.apply(this,["调用beforeLoadDataHandler错误:"+o]);return}}if(s){if(t.isArray(this.option.data)){a=this.option.data}else{if(t.isFunction(this.option.data)){try{a=this.option.data.apply(this,[e])}catch(o){f.apply(this,["调用data错误:"+o]);return}}else{if(typeof this.option.data==="string"){try{a=c.apply(this,[e])}catch(o){f.apply(this,["Ajax错误:"+o]);return}}else{f.apply(this,["遇到未知的data参数！"]);return}}}}t.each(a,function(a,s){if(i.option.maxItems>0&&n.length>=i.option.maxItems){return false}if(t.isPlainObject(s)){var o=t.extend(false,{},s)}else{if(typeof s==="string"){var o={label:s,value:s,image:s}}else{f.apply(i,["数据源Item类型错误！"]);return false}}if(i.option.matchHandler.apply(i,[e,o])){n.push(o)}});if(e==this.inputView.val()){if(n.length>0){r.apply(this,[n])}else{p.apply(this)}}};var f=function(i){if(t.isFunction(this.option.onerror)){this.option.onerror.apply(this,[i])}};i.prototype.setOption=function(i){if(t.isPlainObject(i)){this.option=t.extend(false,this.option,i)}else{if(typeof i==="string"){switch(i){case"destroy":this.destroy();break;case"show":this.show();break;default:f.apply(this,["未知的AutoComplete参数！"]);return}}else{f.apply(this,["未知的AutoComplete参数类型！"]);return}}};i.prototype.destroy=function(){this.searchView.remove();this.inputView.unbind("keyup",this._keyup).unbind("keydown",this._keydown).unbind("blur",this._blur);delete this.inputView.get(0).controller};i.prototype.show=function(){if(this.option.async){setTimeout(function(){u.apply(this)},0)}else{u.apply(this)}};var d=function(i,e){var a=RegExp("^"+i.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1"),"i");if(this.option.emphasis&&t.isFunction(this.option.emphasisHandler)){this.option.emphasisHandler.apply(this,[i,e])}return a.test(e.value)};var y=function(t,i){var e=RegExp("("+t.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")+")","ig");i.label=i.label.replace(e,"<em>$1</em>")}})(jQuery);
//rebuild by neat 